<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>DynamicData.h</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
    <body onload="prettyPrint()">
        <h4></h4>
        <pre class="prettyprint lang-cpp linenums">
ï»¿// Dx/DynamicData.h - dynamic data from Dx to client render
#pragma once
namespace prj_3d::HelloWinHlsl::Dx { 

template&lt;class T&gt; struct ClientDynamicData;

namespace detail_ {
template&lt;class T&gt; 
struct CommonClientDynamicData {
	typedef uptr&lt; ClientDynamicData&lt; T &gt; &gt; uptrc_t;
	typedef const uptrc_t &amp;cref_ptr_t;
};
} // namespace detail_

template&lt;class T&gt; 
struct ClientDynamicData : public detail_::CommonClientDynamicData&lt;T&gt; {
};
template&lt;&gt; 
struct ClientDynamicData&lt;DxVer::v12&gt; : public detail_::CommonClientDynamicData&lt;DxVer::v12&gt; {
	const CPtr&lt; ID3D12GraphicsCommandList &gt; m_pcCommandList;
	const D3D12_CPU_DESCRIPTOR_HANDLE m_stRtvHandle;
	const bool m_isWindowed;
	const HWND m_hWnd;
};

// primary template, "typename = void" for partial specialization
template&lt;class T, typename = void&gt; struct DynamicData;

namespace detail_ {
template&lt;class T&gt; 
struct CommonDynamicData {
	typedef sptr&lt; DynamicData&lt; T &gt; &gt; sptr_t;
	typedef const sptr_t &amp;cref_ptr_t;
	// make shared_ptr, work with single argument too
<span style = "background-color:#fdd">	template&lt;typename... Args&gt; static auto z_make_shared(Args&amp;&amp;... args) {
		return std::make_shared&lt; DynamicData&lt; T &gt; &gt; ( </span>
				DynamicData&lt; T &gt;{ 
					// parent struct aggregate initialization
					{ }
					// real arguments
					, std::forward&lt;Args&gt;(args)... 
				}
			);
<span style = "background-color:#fdd">	}</span>
};
} // namespace detail_

// dummy/empty, the partial specialization other Dx
template&lt;class T&gt; struct DynamicData&lt;T&gt; : public detail_::CommonDynamicData&lt;T&gt; {
<span style = "background-color:#fdd">	auto forClient() const {
		return std::make_unique&lt; ClientDynamicData&lt;T&gt; &gt;( );
	}</span>
};

// the full specialization Dx12
template&lt;&gt; struct DynamicData&lt;DxVer::v12&gt; : public detail_::CommonDynamicData&lt;DxVer::v12&gt; { 
	typedef sptr&lt; const DynamicData&lt; DxVer::v12 &gt; &gt; sptrc_t;
	typedef const sptrc_t &amp;cref_ptr_t;

	CPtr&lt; ID3D12GraphicsCommandList &gt; m_pcCommandList;
	D3D12_CPU_DESCRIPTOR_HANDLE m_stRtvHandle;
	bool m_isWindowed;
	HWND m_hWnd;
<span style = "background-color:#fdd">	auto setCommandList(const CPtr&lt; ID3D12GraphicsCommandList &gt; pcCommandList) {
		m_pcCommandList = pcCommandList;
	}</span>

<span style = "background-color:#fdd">	void setRtvHandle(const D3D12_CPU_DESCRIPTOR_HANDLE &amp;rtvHandle) {
		m_stRtvHandle = rtvHandle;
	}</span>

<span style = "background-color:#fdd">	void setWindowed(bool isWindowed) {
		m_isWindowed = isWindowed;
	}</span>

<span style = "background-color:#fdd">	void setWindowHandle(HWND hWnd) {
		m_hWnd = hWnd;
	}</span>

<span style = "background-color:#fdd">	auto forClient() const {
		return std::make_unique&lt; Tpl::Trait::aggregate_adapter_empty_parent&lt; ClientDynamicData&lt; DxVer::v12 &gt; &gt; &gt;(</span>
				m_pcCommandList
				, m_stRtvHandle
				, m_isWindowed
				, m_hWnd
			);
<span style = "background-color:#fdd">	}</span>
};
} // namespace prj_3d::HelloWinHlsl::Dx</pre>
        <hr />
        <table width="100%">
            <thead>
                <tr>
                    <th align="center">
                        <small>Generated by</small>
                        <a href="https://github.com/OpenCppCoverage/OpenCppCoverage/releases">
                            <strong>OpenCppCoverage (Version: 0.9.9.0)</strong>
                        </a>
                    </th>
                </tr>
            </thead>
        </table>
    </body>
</html>